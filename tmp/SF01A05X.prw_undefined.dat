#Include "Protheus.ch"
#Include "ATFA126.ch"

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ SF01A05X ³ Autor ³ Walmir Junior         ³ Data ³ 13/04/2017±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±ºDesc.     ³ Fonte da customização na rotina de Transferencia por Lote  º±±
±±º          ³ browse de aprovação de Sol Baixa/Transf.                   º±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ ATF                                                        ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
User Function SF01A05X()
                                                                                            		
Local aCores := {}
Private cCadastro := STR0007	//"Análise das solicitações de baixa e transferência de Ativo"
Private aRotina   := MenuDef()
//Walmir Junior 04/05/2017 - Controle de acesso Filial de Destino no Aceite de Solicitação de Transferência.
Public _cXFIL		:= xFilial("SNM")
//Variável para manter campos, informados pelo usuário
Public _aFldUs	:= {}

If SuperGetMv( "MV_ATFSOLD", .F., "2" ) == "2"
	Help(" ",1,"AFA126SOLD",,STR0008,1,0) //"Controle de solicitações desativado, verifique parâmetro 'MV_ATFSOLD'." 
	Return Nil
EndIf

If FindFunction("CTBINTRAN")
	lCtbInTran := CtbInTran( 1, .F. )
Else
	Help(" ",1,"AFA126CTB",,STR0027,1,0) //"Função CTBINTRAN não está presente no ambiente. Por favor atualizar."
	lCtbInTran := .F.
EndIf

aAdd( aCores, { "NM_SITSOL == '2'", "BR_VERDE"    } ) //Aprovada
aAdd( aCores, { "NM_SITSOL == '3'", "BR_VERMELHO" } ) //Rejeitada
//Walmir Junior - 17/04/2017 - Alteração das Legendas de Transferencias
aAdd( aCores, { "NM_TIPOSOL == '2' .And. NM_SITSOl == '1' .And. NM_XACEIT != .T. ", "BR_AZUL"  } ) //Pendente de Aprovação
aAdd( aCores, { "(NM_TIPOSOL == '1' .And. NM_SITSOl == '1') .Or. (NM_TIPOSOL == '2' .And. NM_SITSOl == '1' .And. NM_XACEIT == .T.) ", "BR_AMARELO"  } ) //Pendente de Aceite

dbSelectArea("SE1")
SE1->(dbSetOrder(1))

//Walmir Junior - INÍCIO das customizações da J2A.

_nAx := AScan(aRotina, { |x| UPPER(AllTrim(x[2])) == UPPER(AllTrim("ATFA126Leg"))})
ADel(aRotina, _nAx)	//Remove - Legendas PADRÃO
AIns(aRotina, _nAx)
aRotina[_nAx]	:= { "Legendas", "U_SF01A08X()" , 0, 2         }; //"Legendas"

_nAx := AScan(aRotina, { |x| UPPER(AllTrim(x[2])) == UPPER(AllTrim("ATFA126Apr"))})
ADel(aRotina, _nAx)	//Remove - Aprovar PADRÃO
AIns(aRotina, _nAx)
aRotina[_nAx]	:= { "Aprovar", "U_SF01A09X" , 0, 4         }; //"Aprovar"

_nAx := Len(aRotina) + 1	
aSize(aRotina, _nAx)
aRotina[_nAx]	:= { "Aceite", "U_SF01A10X" , 0, 4         }; //"Aceite"

//Walmir Junior - FIM das customizações da J2A.

mBrowse( 6, 1, 22, 75, "SNM", ,/*cCpo*/,/*nPar08*/,/*cFun*/,/*nClickDef*/,aCores,/*cTopFun*/,/*cBotFun*/,/*nPar14*/,/*bInitBloc*/,/*lNoMnuFilter*/,/*lSeeAll*/,/*lChgAll*/)

Return

Static Function MenuDef()

Local aRotina := { { STR0018, "AxPesqui"  , 0 , 1, ,.F.	},; //"Pesquisar"
{ STR0019, "AxVisual"  , 0 , 2		},; //"Visualizar"
{ STR0020, "ATFA126Apr", 0 , 4		},; //"Aprovar"
{ STR0021, "ATFA126Apr", 0 , 4		},; //"Rejeitar"
{ STR0022, "ATFA126Leg", 0 , 5, ,.F.	} }	//"Legenda"

Return( aRotina )
