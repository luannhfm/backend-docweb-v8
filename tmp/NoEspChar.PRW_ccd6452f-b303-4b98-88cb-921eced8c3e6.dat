#INCLUDE "PROTHEUS.CH"  

//Remover caracteres especiais
User Function NoEspChar(cTxt) // --> C

Local cChr, nPos, cEsp, cRep

cEsp := "的僕麥奼衾譏薹拏衈�朊椔冾笚龔栳摋薃叅礱膰鐉骭曒╩錝籙趡�&"
cRep := "ao123AEIOUAOAEIOUAEIOUAEIOUACNYaeiouaoaeiouaeiouaeioucnye"

For nPos := 1 To Len(cTxt)
	cChr := SubStr(cTxt, nPos, 1)
	If cChr $(cEsp) 		                 //Tratamento da tabela de substitui誽o
		cTxt := StrTran(cTxt, cChr, SubStr(cRep, At(cChr, cEsp), 1), nPos, 1)
	ElseIf cChr $("[\/]^`")     		     //Caractres ignorados
		cTxt := StrTran(cTxt, cChr, "_", nPos, 1)
	ElseIf cChr < " " .Or. cChr > "z" 	  //Outros caracteres especiais ignorados
		cTxt := StrTran(cTxt, cChr, "?", nPos, 1)
	Endif
Next

Return(cTxt)
