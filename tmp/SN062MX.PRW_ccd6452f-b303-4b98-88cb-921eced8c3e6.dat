#INCLUDE "PROTHEUS.CH"
#INCLUDE "APWIZARD.CH"
#INCLUDE "RWMAKE.CH"
#INCLUDE "FONT.CH"
#INCLUDE "COLORS.CH"
#INCLUDE "TOPCONN.CH"
#INCLUDE "TOTVS.CH"
#INCLUDE "FWMVCDEF.CH"		
#INCLUDE "FWMVCDEF.CH"
#INCLUDE "FWMBROWSE.CH"
/*
+--------------------------------------------------------------------------+
|{Protheus.doc}<SN062MX>                                                   |
| Visualizar o Cadastro dos CARTÕES                                        |
|@Author<Antonio Dantas>                                                   |
|@since<10/12/2014>                                                        |
|@version<Nil>                                                             |
|                                                                          |
|@parameters:                                                              |
|@return                                                                   |
|<>                                                                        |
+-----------+--------------------------------------------------------------+
|Uso        |FIEMT - Federacao das Industrias no Estado de Mato Grosso     |
+-----------+--------------------------------------------------------------+
*/

User Function SN062MX()
Local _oMBrowse 	:= FWMBrowse():New() 
Local _cFilterD		:= "ZP3_FILIAL == '"+FwxFilial("ZP3")+"' .and. ZP3->ZP3_XCONVE == "+ZP1->ZP1_XCONV
Private aRotina 	:= MenuDef() 
Private _cCadastro 	:= "Visualização de Carõtes Pré Pago" 
Private _cAlias		:= "ZP3"
//--
_oMBrowse:AddLegend( "ZP3->ZP3_XSTATU == 'P'"	,"BR_MARROM"	   	, "Preparado"				  		)
_oMBrowse:AddLegend( "ZP3->ZP3_XSTATU == 'L'"	,"ENABLE" 			, "Liberado Para Remessa"			)
_oMBrowse:AddLegend( "ZP3->ZP3_XSTATU == 'E'"	,"BR_LARANJA"		, "Remessa Gerada"              	) 
_oMBrowse:AddLegend( "ZP3->ZP3_XSTATU == 'R'"	,"CANCEL_15.PNG"	, "Rejeitado"						)
_oMBrowse:AddLegend( "ZP3->ZP3_XSTATU == 'C'"	,"BSTART.PNG"		, "Conveniado"						)
_oMBrowse:AddLegend( "ZP3->ZP3_XSTATU == 'X'"	,"BR_PRETO" 		, "Extraviado/Roubando"		   		)
_oMBrowse:AddLegend( "ZP3->ZP3_XSTATU == 'T'"	,"BR_VERMELHO.BMP"	, "Transferido"						)
//--
dbSelectArea(_cAlias)
(_cAlias)->(dbSetOrder(1)) 
(_cAlias)->(dbGotop())
//--
_oMBrowse:SetAlias(_cAlias)    
_oMBrowse:SetFilterDefault(_cFilterD)  
_oMBrowse:SetDescription(_cCadastro)   
_oMBrowse:DisableDetails()
_oMBrowse:Activate()	
Return

/*
+--------------------------------------------------------------------------+
|{Protheus.doc}<MenuDef>                                                   |
|Definicao do MenuDef                                                      |
|@Author<Antonio Dantas>                                                   |
|@since<10/12/2014>                                                        |
|@version<Nil>                                                             |
|                                                                          |
|@parameters:                                                              |
|@return                                                                   |
|<   _aRotina (a) - Vetor com as opcoes de Menu                            |
|>                                                                         |
+-----------+--------------------------------------------------------------+
|Uso        |FIEMT - FederaCAO das Industrias no Estado de Mato Grosso     |
+-----------+--------------------------------------------------------------+
*/
Static Function MenuDef()
Local _aRotina := {}
ADD OPTION _aRotina TITLE "Pesquisar"  	ACTION "PESQBRW"         	OPERATION 1 ACCESS 0
ADD OPTION _aRotina TITLE "Visualizar" 	ACTION "VIEWDEF.SN062MX" 	OPERATION 2 ACCESS 0
ADD OPTION _aRotina TITLE "Imprimir"   	ACTION "VIEWDEF.SN062MX" 	OPERATION 8 ACCESS 0
Return _aRotina               


/*
+--------------------------------------------------------------------------+
|{Protheus.doc}<ModelDef>                                                  |
|Definicao do ModelDef                                                     |
|@Author<Antonio Dantas>                                                   |
|@since<10/12/2014>                                                        |
|@version<Nil>                                                             |
|                                                                          |
|@parameters:                                                              |
|@return                                                                   |
|<   _aRotina (a) - Vetor com as opcoes de Menu                            |
|>                                                                         |
+-----------+--------------------------------------------------------------+
|Uso        |FIEMT - FederaCAO das Industrias no Estado de Mato Grosso     |
+-----------+--------------------------------------------------------------+
*/
Static Function ModelDef()
Local _oModel			:= Nil 
Local _oStructMD		:= FWFormStruct(1,_cAlias)
//-- Objeto de modelo de dados
_oModel := MPFormModel():New("SN062MXX", /*Pre-Validacao*/, /*Pos-Validacao*/, /*Commit*/,/*Cancel*/)
//-- A  estrutura  do  modelo  de  dados  (Model) 
_oModel:AddFields("ZP3MASTER",/*cOwner*/,_oStructMD,/*Pre-Validacao*/,/*Pos-Validacao*/)
//-- Chave Primaria
_oModel:SetPrimaryKey({"ZP3_FILIAL","ZP3_XCPF","ZP3_XCONVE"})
Return _oModel  


/*
+--------------------------------------------------------------------------+
|{Protheus.doc}<ViewDef>                                                   |
|Definicao do ViewDef                                                      |
|@Author<Antonio Dantas>                                                   |
|@since<10/12/2014>                                                        |
|@version<Nil>                                                             |
|                                                                          |
|@parameters:                                                              |
|@return                                                                   |
|<   _aRotina (a) - Vetor com as opcoes de Menu                            |
|>                                                                         |
+-----------+--------------------------------------------------------------+
|Uso        |FIEMT - FederaCAO das Industrias no Estado de Mato Grosso     |
+-----------+--------------------------------------------------------------+
*/
Static Function ViewDef()
Local _oModel 		:= FWLoadModel("SN062MX")
Local _oStructVD	:= FWFormStruct(2,_cAlias)
Local _oView		:= FWFormView():New()
_oView:SetModel(_oModel)
_oView:AddField("SN062MXV",_oStructVD,"ZP3MASTER")   
_oView:CreateHorizontalBox("CARTAO",100)
_oView:SetOwnerView("SN062MXV", "CARTAO")
&&--_oView:EnableControlBar(.T.)  
Return _oView  

