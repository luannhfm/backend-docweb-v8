#include 'protheus.ch'

/*/{Protheus.doc} CN150VLD
	Ponto de Entrada criado com o objetivo de customizar a validação no 
	momento em que o usuário confirma a Aprovação da Revisão do Contrato.

@author franklin.oliveira
@since 19/04/2016
@version undefined
@type function

@return lRet, Lógico, .T. = Aprova a Revisão do Contrato .F. = Não Aprova a Revisão do Contrato
/*/
User Function CN150VLD()
	
Local aArea		:= GetArea()

Local lRet 		:= .T.
Local lMedEvent	:= Posicione("CN1", 1, xFilial("CN1") + CN9->CN9_TPCTO, "CN1_MEDEVE") == "1"
Local lCtoVenda	:= Posicione("CN1", 1, xFilial("CN1") + CN9->CN9_TPCTO, "CN1_ESPCTR") == "2"
Local lCtoFlex	:= Posicione("CN1", 1, xFilial("CN1") + CN9->CN9_TPCTO, "CN1_CTRFIX") == "2"

	If SubStr(CN9->CN9_FILIAL, 1, 4) == '02MT'
		If !Empty(CN9->CN9_XOPORT) .And. !Empty(CN9->CN9_XREVOP) .And. lMedEvent .And. lCtoVenda .And. lCtoFlex
			lRet := .F.
			Help('', 1, 'CN150VLD', , "A revisão selecionada deve ser aprovada pela rotina 'Aprovar Aditivo'", 1, 0)
		EndIf
	EndIf
	
	RestArea(aArea)

Return lRet