#Include "Protheus.Ch"

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³MT160GRPC ºAutor  ³Paulo Schwind       º Data ³  05/25/12   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
User Function MT160GRPC()
Local _aArea   := GetArea()
Local _aAreaC1 := SC1->(GetArea())
Local _aSC8    := PARAMIXB[2]
//Local _cNumPr  := ""

Local _nPNumSc  := aScan( _aSC8[1][1], { |x| AllTrim(x[1]) == "C8_NUMSC" } )
Local _nPNumSc  := aScan( _aSC8[1][1], { |x| AllTrim(x[1]) == "C8_NUMSC" } )
Local _nPItemSc := aScan( _aSC8[1][1], { |x| AllTrim(x[1]) == "C8_ITEMSC" } )
Local _nPRecno  := aScan( _aSC8[1][1], { |x| AllTrim(x[1]) == "SC8RECNO" } )

DbSelectArea("SC8")
SC8->( dbGoto( _nPRecno ) )
// Paulo Schwind - 12/07/2019
// Trecho corrigido pois por Pnão estava funcionando
//_cNumPr := SC8->C8_NPROC
SC7->C7_NUMPR := SC8->C8_NPROC //_cNumPr

// Paulo Schwind - Busca na SC o campo de Classificação
SC1->(DbSetOrder(1))
if SC1->(DbSeek(xFilial("SC1")+_aSC8[1][1][_nPNumSc][2] + _aSC8[1][1][_nPItemSc][2]))
   SC7->C7_XCLSSC := SC1->C1_XCLSSC
   SC7->C7_XCLPLC := SC1->C1_XCLPLC
endif

RestArea( _aAreaC1 )
RestArea( _aArea )
Return()
