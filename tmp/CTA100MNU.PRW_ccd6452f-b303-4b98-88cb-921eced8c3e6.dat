#Include 'Protheus.ch'

/*/{Protheus.doc} CTA100MNU
@description Adicionar botões no menu principal da rotina de manutenção de contratos.
@type User Function
@author Cadubitski
@since 01/09/2011
@version 11.0
@see http://tdn.totvs.com/pages/releaseview.action?pageId=6089605
@history 25/07/2014, Peder Munksgaard - Do.it Sistemas, Criada a opção 'Historico Contrato' à fim de exibir os registros referentes ao contrato ponteirado, inibidos pelo filtro da MBrowse principal. 
@history 25/07/2014, Peder Munksgaard - Do.it Sistemas, Criada função auxiliar u_montacols para facilitar a montagem do acols utilizado pelo modelo2 utilizado.
@history 25/05/2015, Antonio Dantas, Inclui botão para Chamada a Opção "Fecha Contrato CRM": Chama a rotina fClosCRM() - Descrita em [SS7399X.prw], que, ira grava o campo [CN9_XSRVEX - Serviço Executado] com o valor "S" identificado assim para CRM que os serviços relativos ao contrato foram executados.
@history 09/07/2015, Jonas Nascimento, Inclui botão para Chamar a Opção "Gera Contrato SESI": Chama a rotina U_SS6925X() Descrita em [SS6925X.prw], que gerará o contrato no Microsoft Word. 
@history 27/09/2015, Jose Leite - CSI, Inclui botão para Chamar a Opção "Gera Contrato SENAI": Chama a rotina U_SN6925X() Descrita em [SN6925X.prw], que gerará o contrato no Microsoft Word.
@history 12/04/2018, Franklin B. Oliveira, Ajustes para a versão 12
@history 27/02/2019, Alan Teles de Oliveira, Trazendo documentação para padrão Protheus.DOC.
@history 27/02/2019, Alan Teles de Oliveira, Movido as funções FMTA001 e MontaCols desse arquivo para FMTA001.prw.
@history 28/02/2019, Alan Teles de Oliveira, Removido opção de incluir planilha devido problemas de compatibilidade com Protheus 12 orientado a utilizar opções de cronograma contábil e financeiro do ações relacionadas do contrato.
@hisyory 05/06/2019, Paulo Schwind, Adicionada opção para emitir Doc Word - Termo de Adesão  
@hisyory 25/02/2022, Gustavo krebs, Adicionada opção responsável pelo controle de situações do contrato -   
/*/
User Function CTA100MNU()

	Local _aArea := GetArea()

	aAdd(aRotina,{"Imprime Doc"				,"U_SIGCTR01"		,0,6,0,Nil })
	aAdd(aRotina,{"Compartilhamento"		,"U_SIESTA08"		,0,7,0,Nil })
	aAdd(aRotina,{"Gestores do Contrato"	,"U_SIESTC01"		,0,7,0,Nil }) 
	aAdd(aRotina,{"Historico Contrato"		,"U_FMTA001"		,0,8,0,Nil }) 
	//+------------------------------------------------------------------+
	//| Antonio Dantas                                       29/05/2015. |
	//| IMPORTANTE: Veja comentario no cabeçalho.                        |
	//+------------------------------------------------------------------+
	aAdd(aRotina,{"Fecha Contrato CRM"		,"U_fClosCRM()"		,0,5,0,Nil }) 
	//+------------------------------------------------------------------+
	//| Jonas Nascimento (J2A Consultoria)                   09/07/2015. |
	//| IMPORTANTE: Veja comentario no cabeçalho.                        |
	//+------------------------------------------------------------------+
	If "02MT" $ cFilAnt 
		aadd(aRotina,{"Gerar Contrato"	,"U_SS6925X"    ,0,6,0,Nil })
		/*If cFilAnt $ "02MT0008|02MT0012" 
			aadd(aRotina,{"Inc. Planilhas"	,"U_SF69A01J"	,0,4,0,Nil })
		EndIf*/
	ElseIf "03MT" $ cFilAnt 
		aadd(aRotina,{"Gerar Contrato"	,"U_SN6925X"		,0,6000,0,Nil })
		//+------------------------------------------------------------------+
		//| Jose Leite - CSI                                     26/10/2016. |
		//| IMPORTANTE: Vincula planilha Fin e Cronog Contabil de acordo com |
		//| a proposta CRM                                                   |
		//+------------------------------------------------------------------+
		//aadd(aRotina,{"Inc. Planilhas"	,"U_SF69A01J"	,0,4,0,Nil })
	EndIf

	//+------------------------------------------------------------------+
	//| Jonas Nascimento (J2A Consultoria)                   06/08/2015. |
	//| IMPORTANTE: Veja comentario no cabeçalho.                        |
	//+------------------------------------------------------------------+
	ADel(aRotina, AScan(aRotina, { |x| UPPER(AllTrim(x[2])) == UPPER(AllTrim("CN100Situac"))}))	//Remove - Situação PADRÃO
	aSize(aRotina, Len(aRotina)-1)
	aadd(aRotina, {"Situação", "U_SS6901X()", 0, 4, 0, Nil})	//Adiciona - Situação CUSTOMIZADA

	//ADel(aRotina, AScan(aRotina, { |x| UPPER(AllTrim(x[2])) == UPPER(AllTrim("MsDocument"))})) //Conhecimento PADRÃO
	ADel(aRotina, AScan(aRotina, { |x| UPPER(AllTrim(x[2])) == UPPER(AllTrim("CN300Docum"))})) //Conhecimento PADRÃO
	aSize(aRotina, Len(aRotina)-1)
	aadd(aRotina, {"Conhecimento", "U_SS6902X(,,,,3)", 0, 4, 0, Nil})	//Adiciona - Conhecimento CUSTOMIZADA    

	// Paulo Schwind - 05/06/2019
	// Gerar Doc. Word - Termo de Adesão
	aadd(aRotina,{"Termo de Adesão"	,"U_SF69R01X()", 0, 4, 0, Nil})	

	//+------------------------------------------------------------------+
	//| Gustavo Krebs  (J2A Consultoria)                   25/02/2022.   |
	//| IMPORTANTE: Veja comentario no cabeçalho.                        |
	//+------------------------------------------------------------------+
	aadd(aRotina,{"Integração SE"	,"U_SF69A15X()", 0, 4, 0, Nil})	

	RestArea(_aArea)

Return
