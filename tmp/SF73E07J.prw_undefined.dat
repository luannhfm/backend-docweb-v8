#include 'protheus.ch'
#include 'parmtype.ch'
#include 'topconn.ch'

/*/{Protheus.doc} SF73E07J
Validacao de usuario executada no campo AD1_XOPRRG
para validar as inforacoes digitadas pelo usuario

@author 	Jose Leite de Barros Neto
@since 		08/08/2017
@version 	1.0

@type function
/*/
User Function SF73E07J(p_cDados)
	
	Local _lRet 	:= .T.
	Local _cQuery	:= ""
	
	If Select("TRA") > 0
		DbSelectArea("TRA")
		TRA->(DbCloseArea())
	EndIf
		
	_cQuery := " SELECT * FROM "+RetSQLName("SX5")+ " "+ CRLF 
	_cQuery += " WHERE X5_FILIAL = ' ' "+ CRLF
	_cQuery += " AND X5_TABELA = '12'  "+ CRLF 
	_cQuery += " AND X5_CHAVE <> 'EX'  "+ CRLF
	_cQuery += " AND X5_CHAVE IN "+ FormatIn(AllTrim(p_cDados),";") +" "+ CRLF
	_cQuery += " AND D_E_L_E_T_ <> '*' "+ CRLF
	
	TCQUERY _cQuery NEW ALIAS "TRA"
		
	If Empty(TRA->(X5_CHAVE))
		_lRet := .F.
		Alert("Algum estado informado nÃ£o existe, favor verificar!")
	EndIf

	TRA->(DbCloseArea())
	
Return(_lRet)