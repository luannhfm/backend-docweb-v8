#Include 'protheus.ch'
#Include 'parmtype.ch'

/*/{Protheus.doc} SF73E08J
Execblock para validar o status do cliente junto a receita (A1_XSITREC)

@author 	Jose Leite de Barros Neto
@since 		15/09/2017
@version 	undefined
@param 		p_cCod, Caracter , Codigo do Cliente
@param 		p_cLoja, Caracter , Loja do Cliente
@type 		function
/*/
User function SF73E08J(p_cCod, p_cLoja)
	
	Local _aArea := GetArea()
	Local _lRet  := .T.
	Local _cMsg	 := ""
	
	DbSelectArea('SA1')
	SA1->(DbSetOrder())
	If SA1->(DbSeek(FwXFilial('SA1') + p_cCod + p_cLoja))
		If AllTrim(SA1->A1_PESSOA) == 'J' .And. AllTrim(SA1->A1_XSITREC) <> '1'
			_cMsg := "Favor verificar o cliente informado, o mesmo esta com Status na Receita diferente de Ativo!"
			MsgInfo(_cMsg,"Status na Receita")
			
			_lRet := .F.
		EndIf
	EndIf
	
	RestArea(_aArea)
	
Return(_lRet)