/*/
===============================================================================
Autor.............: Peder Munksgaard (Do.it Sistemas)
-------------------------------------------------------------------------------
Data..............: 23/07/2014
-------------------------------------------------------------------------------
Descrição.........: Ponto de entrada na inclusão da planilha de um contrato 
                    responsável por filtrar os Pedidos de Compras que poderão
                    ser importados. 
-------------------------------------------------------------------------------
Alteração.........: (dd/mm/aaaa) - Motivo

                    (11/08/2014) - Contemplado no filtro amarração entre 
                    planilha de medição e pedido de compras importado.
                    Não serão exibidos pedidos de compras que possuam o campo
                    C7_XGERGCT = 'S' e campo C7_XCONTRA preenchido.
                    
-------------------------------------------------------------------------------
Partida...........: CNTA200()
-------------------------------------------------------------------------------
Função............: u_CN200PID()
===============================================================================
/*/

#Include "Protheus.ch"

User Function CN200PID()

   Local _aArea := GetArea()
   Local _cFil  := ''
   
   _cFil := 'C7_CONTRA == "' + Space(TamSX3("C7_CONTRA")[1]) + '" .And. C7_FORNECE == CNA_FORNEC .And. C7_CONAPRO == "L"'
   _cFil += ' .And. C7_XGERGCT <> "S" .And. C7_XCONTRA == "' + Space(TamSX3("C7_XCONTRA")[1]) + '"'

   RestArea(_aArea)

Return _cFil