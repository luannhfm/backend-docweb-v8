#Include 'Protheus.ch'

/*/{Protheus.doc} SF07E01J
Execblock para validar o Item x Centro

@author 	Jose Leite de Barros Neto
@since 		09/03/2015
@version 	1.0
@return 	T, Logico
/*/
User Function SF07E01J()
	
	Local _lRet		:= .T.	
	Local _aArea 		:= GetArea()
	Local _aAreaCTA 	:= CTA->(GetArea())
	Local _cFilial		:= ""
	Local _cCentro		:= ""
	Local _cItemC		:= ""
	
	If INCLUI 
		_cFilial	:= xFilial("CTA")
		_cCentro 	:= M->RA_CC
		_cItemC		:= M->RA_ITEM 
	Else
		_cFilial	:= Padr(SubStr(SRA->RA_FILIAL,1,4),TamSx3("CTA_FILIAL")[1])
		_cCentro 	:= SRA->RA_CC
		_cItemC		:= SRA->RA_ITEM
	EndIf
	
	DbSelectArea("CTA")
	CTA->(DbSetOrder(3)) //CTA_FILIAL+CTA_CUSTO+CTA_ITEM
	If .Not. CTA->( DbSeek( _cFilial + _cCentro + _cItemC ) )
		MsgAlert("Não existe a amarração entre Centro de Custo x Item Contábil para os dados informados!")
		_lRet := .F.
	EndIf
	
	CTA->(DbCloseArea())
	
	RestArea(_aAreaCTA)
	RestArea(_aArea)
	
Return( _lRet )