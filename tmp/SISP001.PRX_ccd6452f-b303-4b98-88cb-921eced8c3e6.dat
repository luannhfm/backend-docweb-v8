#include "rwmake.ch"

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Programa  ³ SISP001  ³ Autor ³ Wagner Farias         ³ Data ³ 15/08/12 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ ExecBlock disparado para retornar agencia e conta Forncedor³±±
±±³          ³ Campo 024-043.                                             ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ CNAB A PAGAR                                               ³±±
±±³ Cliente  ³ CN1                                                        ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/

User Function SISP001()

Local _cReturn

cBcoemp:= PADL(SUBSTR(SA6->A6_COD,1,3),3,"0")
cBanco := IIF(!EMPTY(SE2->E2_XBANCO),PADL(SUBSTR(SE2->E2_XBANCO,1,3),3,"0"), PADL(SUBSTR(SA2->A2_BANCO,1,3),3,"0"))
cAgenc := IIF(!EMPTY(SE2->E2_XAGENC),PADL(ALLTRIM(SE2->E2_XAGENC),5,"0"), PADL(ALLTRIM(SA2->A2_AGENCIA),5,"0"))
cConta := IIF(!EMPTY(SE2->E2_XNUMCON),PADL(ALLTRIM(SE2->E2_XNUMCON),12,"0"),PADL(ALLTRIM(SA2->A2_NUMCON),12,"0")) 
cDVCta := IIF(!EMPTY(SE2->E2_XDVCTA),SE2->E2_XDVCTA,SA2->A2_XDVCTA)

If cBcoemp == "341" .and. cBanco == "341"
	cConta    := 	IIF(!EMPTY(SE2->E2_XNUMCON),PADL(ALLTRIM(SE2->E2_XNUMCON),6,"0"),PADL(ALLTRIM(SA2->A2_NUMCON),6,"0")) 
	_cReturn :=	PADL(ALLTRIM(cAgenc),5,"0")+" 000000"+PADL(ALLTRIM(cConta),6,"0")+" "+ IIF(SEA->EA_MODELO $ "10/02", "0",cDVCta)
Else

	_cReturn :=	ALLTRIM(cAgenc)+" "+(cConta)+" "+(cDVCta)
EndIf			

Return(_cReturn)
