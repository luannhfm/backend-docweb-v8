#include "totvs.ch"
#include "restful.ch"

//-------------------------------------------------------------------
/*/{Protheus.doc} ProdxAreaAtuacao
DeclaraÃ§Ã£o do ws de Area de AtuaÃ§Ã£o
@author SERGIO SALUSTIANO
@since 01/09/2021
@version 1.0
/*/

WSRESTFUL ProdxAreaAtuacao DESCRIPTION 'endpoint Area de Atuacao API' FORMAT "application/json,text/html"
    WSDATA Page                   AS INTEGER  OPTIONAL
    WSDATA aQueryString           AS ARRAY    OPTIONAL
    
 	WSMETHOD GET ListProdxAreaAtuacao;
	    DESCRIPTION "Retorna uma lista com a Area de Atuacao";
	    WSSYNTAX "/api/sti/ProdxAreaAtuacao" ;
        PATH "/api/sti/ProdxAreaAtuacao" ;
	    PRODUCES APPLICATION_JSON
 	
END WSRESTFUL


/*/{Protheus.doc} GET ProdxAreaAtuacao
MÃ©todo GET com Area de Atuacao
@author SERGIO SALUSTIANO
@since 01/09/2021
@version 1.0
/*/

WSMETHOD GET ListProdxAreaAtuacao QUERYPARAM Page WSREST ProdxAreaAtuacao
Return getListProdxAreaAtuacao(self)

/*/{Protheus.doc} GET getListProdxAreaAtuacao
FunÃ§Ã£o para tratamento da requisiÃ§Ã£o GET
@author SERGIO SALUSTIANO
@since 01/09/2021
@version 1.0
/*/

Static Function getListProdxAreaAtuacao( oWS )
   Local lRet  as logical
   Local oArea as object
   DEFAULT oWS:Page      := 1  
   lRet                  := .T.
   
   oArea := ProdxAreaAtuacaoAdapter():new( 'GET' )
   oArea:setPage(oWS:Page)
   oArea:setPageSize(30)
   oArea:setUrlFilter(oWS:aQueryString)
   oArea:getListProdxAreaAtuacao()
   //Se tudo ocorreu bem, retorna os dados via Json
   If oArea:lOk
       oWS:SetResponse(oArea:getJSONResponse())
   Else
   //Ou retorna o erro encontrado durante o processamento
       SetRestFault(oArea:GetCode(),oArea:GetMessage())
       lRet := .F.
   EndIf
   //faz a desalocaÃ§Ã£o de objetos e arrays utilizados
   oArea:DeActivate()
   oArea := nil
   
Return lRet

