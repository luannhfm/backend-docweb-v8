#Include 'Protheus.ch'

/*/{Protheus.doc} MTA120E
Ponto de Entrada executado na Exclusao de um Pedido de Compra.
 
@type 		function
@author 	Jose Leite de Barros Neto
@since 	01/09/2016
@version 	1.0

@return 	_lRet, Lógico
/*/
User Function MTA120E()

	Local _lRet 		:= .T.
	Local _aArea 	:= GetArea()
	
	/* 	Jose Leite - CSI - 01/09/2016
		PF - Sem Cotacao - Sem SC e Liberado pelo Gestor
		Nao podera excluir o pedido de compras.
	*/
	If SA2->A2_TIPO == 'F' .And. Empty(SC7->C7_NUMCOT) .And. Empty(SC7->C7_NUMSC)
		
		If SC7->C7_CONAPRO == 'L'
			Help("ESPECIFICO", 1, "HELP", "EXCLUSÃO DE PEDIDO","Não é possível realizar a Exclusão do Pedido de Compra já Aprovado pelo Gestor.", 1, 0)
			_lRet := .F.
		ElseIf SC7->C7_CONAPRO == 'B' .And. Empty(SC7->C7_RESIDUO)
			Help("ESPECIFICO", 1, "HELP", "EXCLUSÃO DE PEDIDO","Este pedido não pode ser Excluído, Enviar suporte a CAQC para Eliminar Resíduos.", 1, 0)
			_lRet := .F.
		ElseIf SC7->C7_CONAPRO == 'B' .And. .Not. Empty(SC7->C7_RESIDUO)
		 Help("ESPECIFICO", 1, "HELP", "EXCLUSÃO DE PEDIDO","Este pedido não pode ser Excluído, pois já foi Eliminado Resíduo.", 1, 0)
			_lRet := .F.
		EndIf
		
	EndIf
	
	RestArea(_aArea)

Return( _lRet )