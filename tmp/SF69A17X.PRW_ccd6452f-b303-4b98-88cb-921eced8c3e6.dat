#Include "TOTVS.ch"
#Include "FWMVCDef.ch"
#INCLUDE "TOPCONN.CH"

 /*/{Protheus.doc} SF69A17X
    (Funcao para trazer um listbox com os valores da tabela ZG8)
    @type  Function
    @author user
    @since 12/09/2022
    @version version
    @param param_name, param_type, param_descr
    @return return_var, return_type, return_description
    @example
    (examples)
    @see (links_or_references)
    /*/

User Function SF69A17X 
    Private   nVar := 1234.56
    Private lChk    := .F.
    Private oLbx    := Nil
    Private aVetor  := {}
    Private oDlg, oGet 

    fvet()
    Listbx()

Return 

 /*/{Protheus.doc} Listbx
    (Funcao para montar um listbox -tabela ZG8)
    @type  Function
    @author user
    @since 12/09/2022
    @version version
    @param param_name, param_type, param_descr
    @return return_var, return_type, return_description
    @example
    (examples)
    @see (links_or_references)
    /*/
Static Function Listbx

    Local cTitulo := "Vlr. MÃ¡ximo Hora/Aula"
    Local nx1 := 250 
    Local ny1 := 600
    Local nx2 := 290 //eixo x , horizontal
    Local ny2 := 080 
    Local nx3 := 100
    Local ny3 := 250

    DEFINE MSDIALOG oDlg TITLE cTitulo FROM 0,0 TO nx1,ny1 PIXEL


        @ 10,10 LISTBOX oLbx VAR cVar FIELDS HEADER "Codigo", "Descricao", "Tipo","Vl Max.Hora/Aula" ;
            SIZE nx2,ny2 OF oDlg PIXEL 

        oLbx:SetArray( aVetor )
        oLbx:bLine := ; 
        {|| {   aVetor[oLbx:nAt,1],;
                aVetor[oLbx:nAt,2],;
                aVetor[oLbx:nAt,3],;
                aVetor[oLbx:nAt,4]} }

    DEFINE SBUTTON FROM nx3,ny3 TYPE 1 ACTION {|| oDlg:End()} ENABLE OF oDlg//botao
    ACTIVATE MSDIALOG oDlg CENTER

Return

/*/{Protheus.doc} fvet
    (Funcao para preencher vetor a ser usado na Listbox)
    @type  Static Function
    @author user
    @since 22/08/2022
    @version version
    @param param_name, param_type, param_descr
    @return return_var, return_type, return_description
    @example
    (examples)
    @see (links_or_references)
/*/
Static Function fvet()
    Local cVal1  := ""
    Local aAreaZG8 := ZG8->(GetArea())   

    DbSelectArea('ZG8')
    ZG8->(DbSetOrder(1))
    ZG8->(DbGoTop())

    Do While !ZG8->(Eof())
        cVal1 := Str(ZG8->ZG8_VLMAX,6,2)  

        aAdd(aVetor, {ZG8->ZG8_COD,;
         ZG8->ZG8_DESC,;
         ZG8->ZG8_TIPO,;
         "R$ "+Transform(  cVal1 , "@E 999,99") })

        ZG8->(DbSkip())
    EndDo 
    RestArea(aAreaZG8)
Return 
