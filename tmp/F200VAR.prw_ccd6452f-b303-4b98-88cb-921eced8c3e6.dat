#Include 'Protheus.ch'
#Include 'Topconn.ch'

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³F200VAR   ºAutor  ³Sergio Ricardo      º Data ³  03/07/15   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Foi criado este ponto de entrada, para tratar o desconto    º±±
±±º          ³incondicional que e praticado pela FIEMT.                   º±±
±±º          ³Parametros recebidos:                                       º±±
±±º          ³                     -ParamIXB[1] - { cNumTit,              º±±
±±º          ³                                      dBaixa,               º±±
±±º          ³                                      cTipo,                º±±
±±º          ³                                      cNsNum,               º±±
±±º          ³                                      nDespesas,            º±±
±±º          ³                                      nDescont,             º±±
±±º          ³                                      nAbatim,              º±±
±±º          ³                                      nValRec,              º±±
±±º          ³                                      nJuros,               º±±
±±º          ³                                      nMulta,               º±±
±±º          ³                                      nValOutrD,            º±±
±±º          ³                                      nValCc,               º±±
±±º          ³                                      dDataCred,            º±±
±±º          ³                                      cOcorr,               º±±
±±º          ³                                      cMotBan,              º±±
±±º          ³                                      xBuffer,              º±±
±±º          ³                                      dDtVc,                º±±
±±º          ³                                      aBuffer }             º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ FIEMT                                                      º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
//aValores := ( { cNumTit, dBaixa, cTipo, cNsNum, nDespes, nDescont, nAbatim, nValRec, nJuros, nMulta, nVaLOutrD, nValCc, dDataCred, cOcorr, cMotBan, xBuffer, dDtVc, aBuffer })

User Function F200VAR()

Local _aValores := ParamIxb[01]
Local _nNumerox  := _aValores[4]
Local aArea      := SE1->(GetArea())
Local _cTmp	   := GetNextAlias()
Local cQry       := " " 
Local _cFilialBX := SEE->EE_FILIAL

   
   cQry := "SELECT E1_FILIAL, E1_PREFIXO, E1_NUM, E1_PARCELA, E1_CLIENTE, E1_LOJA, E1_DECRESC "
	cQry += "  FROM "+ RETSQLNAME("SE1") + " SE1 "
	cQry += "WHERE E1_FILIAL = '" + _cFilialBX + "' " 
	cQry += "AND E1_NUMBCO = '" + _nNumerox + "' " 
   cQry += "AND D_E_L_E_T_ <> '*' " 

	cQry := ChangeQuery(cQry )

	dbUseArea( .T., "TOPCONN", TcGenQry(,,cQry), _cTmp, .T., .T. )
	
	If (_cTmp)->( Eof() )
		(_cTmp)->( dbCloseArea() )
	Else
		nDescont := nDescont + (_cTmp)->E1_DECRESC
		(_cTmp)->( dbCloseArea() )
	EndIf
	
	RestArea(aArea)

Return

