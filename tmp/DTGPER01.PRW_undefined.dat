#INCLUDE "PROTHEUS.CH"
#INCLUDE "REPORT.CH"
 
/*/f/
嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈�
<Descricao> :  Fun誽o respons嫛el pela gera誽o do Relat鏎io de Diverg瘽cia na Importa誽o de Horas
<Autor> : F墎rica DOIT SP
<Data> : 02/05/2014
<Parametros> : Nil
<Retorno> : Nil
<Processo> : FIEMT � Importa誽o de Horas
<Tipo> R (Relat鏎io)
<Obs> : 
嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈�
*/

User Function DTGPER01( aErros )

Local oReport
Local lTRepInUse := .T.
Local cTitle     := "Diverg瘽cias na Importa誽o de Horas de Rateio"

If FindFunction("TRepInUse") .And. lTRepInUse
	//矬闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡醴
	//蛆nterface de impressao                                                  �
	//斂闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡囁

	oReport:= TReport():New("DTGPER01", cTitle,, {|oReport| DefPrint(oReport,aErros)}, cTitle)

	oReport:SetLandScape(.T.)
	oReport:ldisableorientation:=.T.
	oReport:GetOrientation(1)

	oReport:PrintDialog()
EndIf

Return

/*/
嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈�
控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控�
控矬闡闡闡闡鐃闡闡闡闡闡薩闡闡闡薩闡闡闡闡闡闡闡闡闡闡闡薩闡闡鐃闡闡闡闡闡膨�
控袈rograma  袒eportPrin� Autor 莧lexandre Inacio Lemes 蛇ata  �06/09/2006陰�
控藥闡闡闡闡霰闡闡闡闡闡謐闡闡闡謐闡闡闡闡闡闡闡闡闡闡闡謐闡闡鐘闡闡闡闡闡敢�
控蛇escri��o � Emissao do Pedido de Compras / Autorizacao de Entrega      陰�
控藥闡闡闡闡霰闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡敢�
控袖intaxe   � ReportPrint(ExpO1,ExpN1,ExpN2)                             陰�
控藥闡闡闡闡霰闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡敢�
控袈arametros� ExpO1 = Objeto oReport                      	              陰�
控�          � ExpN1 = Numero do Recno posicionado do SC7 impressao Menu  陰�
控�          � ExpN2 = Numero da opcao para impressao via menu do PC      陰�
控藥闡闡闡闡霰闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡敢�
控袒etorno   術enhum                                                      陰�
控藥闡闡闡闡霰闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡敢�
控袈arametros蛀xpO1: Objeto Report do Relat鏎io                           陰�
控斂闡闡闡闡鐘闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡棱�
控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控�
葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔�
/*/
Static Function DefPrint(oReport,aErrosImp)

Local lCabec     := .T.
Local nLinha     := 240
Local nX			:= 0
Local oBrush     := TBrush():New("",CLR_LIGHTGRAY)

//----------------------------------------------------------------------------
//
//----------------------------------------------------------------------------------------------------------------

oFont1  := TFont():New( 'Arial', 08, 08, .T., .T., 5, .T., 5, .F., .F. )
oFont2  := TFont():New( 'Arial', 08, 08, .T., .F., 5, .T., 5, .F., .F. )
oFont3  := TFont():New( 'Arial', 09, 09, .T., .F., 5, .T., 5, .F., .F. )
oFont3N := TFont():New( 'Arial', 09, 09, .T., .T., 5, .T., 5, .F., .F. )
oFont4  := TFont():New( 'Arial', 09, 09, .T., .F., 5, .T., 5, .F., .F. )
oFont5  := TFont():New( 'Arial', 10, 10, .T., .T., 5, .T., 5, .F., .F. )
oFont6  := TFont():New( 'Arial', 10, 10, .T., .F., 5, .T., 5, .F., .F. )
oFont7  := TFont():New( 'Arial', 12, 12, .T., .F., 5, .T., 5, .F., .F. )
oFont7N := TFont():New( 'Arial', 12, 12, .T., .T., 5, .T., 5, .F., .F. )
oFont8  := TFont():New( 'Arial', 12, 12, .T., .F., 5, .T., 5, .F., .F. )
oFont9  := TFont():New( 'Arial', 16, 16, .T., .F., 5, .T., 5, .F., .F. )
oFont9N := TFont():New( 'Arial', 16, 16, .T., .T., 5, .T., 5, .F., .F. )
oFont10 := TFont():New( 'Arial', 20, 20, .T., .T., 5, .T., 5, .F., .F. )

//----------------------------------------------------------------------------
//
//----------------------------------------------------------------------------------------------------------------

For nX := 1 To Len( aErrosImp )

	If oReport:Cancel()
		Exit
	EndIf
	
	//----------------------------------------------------------------
	//	Itens
	//--------------------------------------------------------------------------------------------------

	If lCabec

		lCabec := .F.
	
		oReport:FillRect({ (nLinha+3), 0011, (nLinha+60), 3300}, oBrush)
			
		oReport:Box(  nLinha, 0010, (nLinha+60), 3300)

		oReport:Say( (nLinha+10), 0045, "Linha"                                  , oFont3N,,,, 0 )
		oReport:Say( (nLinha+10), 0150, "Centro de Custo"                        , oFont3N,,,, 0 )
		oReport:Say( (nLinha+10), 0400, "Descri誽o"                              , oFont3N,,,, 0 )
		oReport:Say( (nLinha+10), 1000, "Item Cont墎il"                          , oFont3N,,,, 0 )
		oReport:Say( (nLinha+10), 1200, "Descri誽o"                              , oFont3N,,,, 0 )
		oReport:Say( (nLinha+10), 1850, "Matr獳ula"                              , oFont3N,,,, 0 )
		oReport:Say( (nLinha+10), 2050, "Nome"                                   , oFont3N,,,, 0 )
		oReport:Say( (nLinha+10), 2700, "Horas M瘰"                              , oFont3N,,,, 0 )
		oReport:Say( (nLinha+10), 2870, "Horas Ocupa誽o"                         , oFont3N,,,, 0 )
		oReport:Say( (nLinha+10), 3130, "Percentual"                             , oFont3N,,,, 0 )

		nLinha += 70

	EndIf

	If !aErrosImp[nX][10]

		oReport:Say( nLinha, 0045,   StrZero( aErrosImp[nX][11], 5 )                , oFont2,,,, 0 )
		oReport:Say( nLinha, 0200,            aErrosImp[nX][01]                     , oFont2,,,, 0 )
		oReport:Say( nLinha, 0400,            aErrosImp[nX][02]                     , oFont2,,,, 0 )
		oReport:Say( nLinha, 1000,            aErrosImp[nX][03]                     , oFont2,,,, 0 )
		oReport:Say( nLinha, 1200,            aErrosImp[nX][04]                     , oFont2,,,, 0 )
		oReport:Say( nLinha, 1850,            aErrosImp[nX][05]                     , oFont2,,,, 0 )
		oReport:Say( nLinha, 2050,            aErrosImp[nX][06]                     , oFont2,,,, 0 )
		oReport:Say( nLinha, 2750,            aErrosImp[nX][07]                     , oFont2,,,, 0 )
		oReport:Say( nLinha, 2930,            aErrosImp[nX][08]                     , oFont2,,,, 0 )
		oReport:Say( nLinha, 3160, Transform( aErrosImp[nX][09], "@E 999.99" ) + "%", oFont2,,,, 0 )

		nLinha += 40

	EndIf

	If nLinha >= 2500

		lCabec := .T.
		nLinha := 240

		oReport:EndPage()	

   EndIf
		
Next nX
	
Return

/*/f/
嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈�
<Descricao> : Rotina para controle de versao
<Data> : 24/05/2014
<Parametros> : Nenhum
<Retorno> : cRet
<Processo> : Controle de versao
<Tipo> (Menu,Trigger,Validacao,Ponto de Entrada,Genericas,Especificas ) : V
<Autor> : Doit Sistemas
<Obs> :
嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈�
*/

User Function DTGPER1V()

Local cRet := ""
cRet := "20140523"
 
Return cRet