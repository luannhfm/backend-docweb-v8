/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³ RdMake   ³ SICOMA49 ³ Autor ³ TOTVS..               ³ Data ³JAN/2013  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Cria registro no SBZ para todas as filiais conforme SB1.    ³±±
±±           ³                               							  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³                                                            ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
User Function SICOMA49()

Local aArea		:= GetArea() 
Local aAreaSM0	:= SM0->(GetArea())
Local aAreaSBZ	:= SBZ->(GetArea())
Local nRet		:= 0

nRet := Aviso("Gera indicador de produto.","Deseja gerar cadastro de indicador do produto para todas as filiais?",{"Ok","Cancelar"},2,"Produto "+Alltrim(SB1->B1_COD)+" - "+Alltrim(SB1->B1_DESC))

If nRet == 1
	Processa({|| COMA49a() },"Processando...")
EndIf

RestArea(aAreaSBZ) 
RestArea(aAreaSM0)
RestArea(aArea)

Return()

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³ RdMake   ³ COMA49a  ³ Autor ³ TOTVS..               ³ Data ³ JAN/2013 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Gera SBZ.                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³                                                            ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function COMA49a()

dbSelectArea("SBZ")
dbSetOrder(1)
DbGoTop()	

dbSelectArea("SM0")
dbSetOrder(1)
dbGoTop()

ProcRegua(Reccount())

While !Eof()
	
	IncProc("Processando... "+SM0->M0_CODFIL)
	
	dbSelectArea("SBZ")
	
	If !dbSeek(Alltrim(SM0->M0_CODFIL)+SB1->B1_COD)
		RecLock("SBZ",.T.)
	Else
		RecLock("SBZ",.F.)
	EndIf

	SBZ->BZ_FILIAL	:= SM0->M0_CODFIL
	SBZ->BZ_COD		:= SB1->B1_COD
	SBZ->BZ_DESC	:= SB1->B1_DESC
	SBZ->BZ_LOCPAD	:= SB1->B1_LOCPAD
	SBZ->BZ_TE		:= SB1->B1_TE
	SBZ->BZ_TS		:= SB1->B1_TS
	SBZ->BZ_CODISS	:= SB1->B1_CODISS
	SBZ->BZ_XCRITIC	:= SB1->B1_XCRITIC
	SBZ->BZ_XESTQ	:= SB1->B1_XESTQ
	SBZ->BZ_FINCOM	:= SB1->B1_FINCOM
	SBZ->BZ_ALIQISS	:= SB1->B1_ALIQISS
	If SubStr(SM0->M0_CODFIL,1,4) == "07RS"
		SBZ->BZ_IRRF	:= "N"
	Else
		SBZ->BZ_IRRF	:= SB1->B1_IRRF
	EndIf

	MsUnlock()      

	dbSelectArea("SM0")
	dbSkip()

EndDo

Aviso("Atencao !","Termino do processamento.",{"Ok"})

Return()