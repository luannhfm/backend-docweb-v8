#include 'protheus.ch'

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³ SF06A30X   ºAutor ³ Paulo César P. Schwind ºData³24/05/2019º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Altera a Situacao do Titulo para Recuperacao Judicial      º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/

User Function SF06A30X()
Local _aHstCob

if SE1->E1_XSITUAC == 'K'

   MsgStop( UPPER(AllTrim(LogUserName())) + chr(10)+chr(13);
           +"Titulo já está em Recuperação Judicial. Verifique !" , "ATENÇÃO !!!" )          

Elseif SE1->E1_SALDO = 0

   MsgInfo( UPPER(AllTrim(LogUserName())) + chr(10)+chr(13);
           +"Titulo já baixado. Verifique !" , "ATENÇÃO !!!" )          

Else

    // Paulo Schwind - 23/05/2019 - Altera a Situação dos Titulos parar "Recuperação Judicial" 
	If ApMsgYesNo("A situação do título será alterada para Recuperação Judicial. CONFIRMA ?","ATENÇÃO !")

       RecLock("SE1",.F.)
 	   SE1->E1_XSITUAC := 'K'
	   MsUnLock()
					
	   //-----------------------------------------------------
	   //-- Grava Histórico de cobrança - Recuperação Judicial
	   //-----------------------------------------------------
	   _aHstCob := Array(9)	
	   _aHstCob[1]:= SE1->E1_CLIENTE
	   _aHstCob[2]:= SE1->E1_LOJA
	   _aHstCob[3]:= SE1->E1_PREFIXO
	   _aHstCob[4]:= SE1->E1_NUM
	   _aHstCob[5]:= SE1->E1_PARCELA
	   _aHstCob[6]:= SE1->E1_TIPO
	   _aHstCob[7]:= STOD("//")
	   _aHstCob[8]:= "SITUAÇÃO DO TÍTULO - RECUPERAÇÃO JUDICIAL" + CRLF 
	   _aHstCob[8]+= "Numero do Titulo: "  + SE1->E1_NUM + CRLF
	   _aHstCob[9]:= "01"
	
	   //------------------------------------------------------
	   //-- Chama função que grava historico
	   //------------------------------------------------------
	   U_SF06A74X(_aHstCob,"SF06A30X")
	   
       MsgInfo( UPPER(AllTrim(LogUserName())) + chr(10)+chr(13);
                 +"Situação do título alterada com Sucesso !" , "ATENÇÃO !!!" )          

	Endif				

Endif
Return	
