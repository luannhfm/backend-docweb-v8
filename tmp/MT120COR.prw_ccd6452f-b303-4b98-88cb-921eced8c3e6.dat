#INCLUDE "PROTHEUS.CH" 
#INCLUDE "TBICONN.CH"

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³MT120COR  ºAutor  ³Cadu                º Data ³  Nov/2010   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Ponto de entrada para incluir legenda nova no PC.           º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP                                                         º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/

User Function MT120COR()

Local aNewCores := {}

aAdd(aNewCores,    { 'C7_TIPO!=nTipoPed'                       												, 'BR_PRETO'})			//-- Autorizacao de Entrega ou Pedido
aAdd(aNewCores,    { '!Empty(C7_RESIDUO)'                      												, 'BR_CINZA'})			//-- Eliminado por Residuo
aAdd(aNewCores,    { 'C7_CONAPRO=="B".And.C7_QUJE < C7_QUANT'													, 'BR_AZUL' })			//-- Bloqueado
If nTipoPed == 1
	aAdd(aNewCores,{ '!Empty(C7_CONTRA).And.Empty(C7_RESIDUO) .AND. Empty(C7_DTEMIPT)'						, 'BR_BRANCO'})			//-- Integracao com o Modulo de Gestao de Contratos
EndIf
aAdd(aNewCores,    { 'C7_QUJE==0 .And. C7_QTDACLA==0 .and. Empty(C7_XSTATUS) .AND. Empty(C7_DTEMIPT)'		, 'ENABLE'})				//-- Pendente
aAdd(aNewCores,    { 'C7_QUJE<>0.And.C7_QUJE<C7_QUANT'															, 'BR_AMARELO'})			//-- Pedido Parcialmente Atendido
aAdd(aNewCores,    { 'C7_QUJE>=C7_QUANT'   																		, 'DISABLE'})				//-- Pedido Atendido
aAdd(aNewCores,    { 'C7_QTDACLA >0' 																				, 'BR_LARANJA'})			//-- Pedido Usado em Pre-Nota 

//Novas Legendas
aAdd(aNewCores,    { "C7_QUJE==0 .And. C7_QTDACLA==0 .AND. C7_XSTATUS == '1'"								, 'BR_PINK'})				//-- Recebido pelo fornecedor
aAdd(aNewCores,    { "C7_QUJE==0 .And. C7_QTDACLA==0 .AND. C7_XSTATUS == '2'"								, 'BR_VIOLETA'})			//-- Confirmado pelo fornecedor    
aAdd(aNewCores,    { "C7_QUJE==0 .And. C7_QTDACLA==0 .AND. Empty(C7_XSTATUS) .AND. !Empty(C7_DTEMIPT)"	, 'BR_MARRON'})			//-- WF enviado
aAdd(aNewCores,    { "C7_RESIDUO == 'S' .And. C7_XCONTRA <> ' ' .AND. C7_XGERGCT == 'S'"           		, 'GCTIMG16'})			//-- Vinculado a Planilha de Medição
aAdd(aNewCores,    { "C7_QUJE==0 .And. C7_QTDACLA==0 .and. C7_XSTATUS == '3' .AND. Empty(C7_DTEMIPT)"		, 'fwstd_mnu_mru.png'})	//-- Aguardando Entrega    

Return(aNewCores)