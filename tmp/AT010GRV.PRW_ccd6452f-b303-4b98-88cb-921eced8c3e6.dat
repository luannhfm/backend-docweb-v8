#include "protheus.ch"

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³AT010GRV  ºAutor  ³Microsiga           º Data ³  04/07/12   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ PE de complemento de gravacao do ativo                     º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ MP 11 - SISTEMA INDUSTRIA                                  º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/

User Function AT010GRV()
Local _cArea    := GetArea()
Local _cAreaSX6 := SX6->(GetArea())

IF SN1->(N1_CODBAR <>N1_CBASE)
	// Atualiza Codigo de Barra
	RecLock("SN1",.F.)
	SN1->N1_CODBAR := SN1->N1_CBASE
	SN1->N1_CHAPA  := SN1->N1_CBASE
	SN1->(msUnlock())
	
	// Atualiza parametro
	dbSelectArea("SX6")
	dbSetOrder(1)
	IF dbSeek(LEFT(CFILANT,4)+Space(4)+"MV_CBASEAF")
		RecLock("SX6",.F.)
		FieldPut( FieldPos('X6_CONTEUD'), '"'+Soma1(Alltrim(SN1->N1_CBASE))+'"' )
		FieldPut( FieldPos('X6_CONTSPA'), '"'+Soma1(Alltrim(SN1->N1_CBASE))+'"' )
		FieldPut( FieldPos('X6_CONTENG'), '"'+Soma1(Alltrim(SN1->N1_CBASE))+'"' )
		SX6->(MsUnLock())
	ENDIF
	
ENDIF

RestArea(_cAreaSX6)
RestArea(_cArea)
Return()
