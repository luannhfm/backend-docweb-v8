#include 'Protheus.ch'

/*
嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈嗈�
控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控�
控奼迋迋迋迋迕迋迋迋迋迋冞迋迋迋敊迋迋迋迋迋迋迋迋迋豖迋迋迋敊迋迋迋迋迋迋跼�
控摺rograma  蚶241IND   態utor  蚯ucas Riva Tsuda    � Data �  12/20/11   滷�
控昅迋迋迋迋阹迋迋迋迋迋庋迋迋迋玵迋迋迋迋迋迋迋迋迋虮迋迋迋玵迋迋迋迋迋迋僚�
控慣esc.     袈onto de Entrada para manipular a ordem dos registros na    滷�
控�          速ela de sele誽o de titulos para gerar o bordero             滷�
控昅迋迋迋迋阹迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋僚�
控摻so       蛀specifico CNI                                              滷�
控￢迋迋迋迋迍迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋迋摹�
控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控�
葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔�
*/

User Function F241IND()
Local aArea      := GetArea()
Local aAreaSE2   := SE2->(GetArea())
Local _cAliasSE2 := Alias()
Private cPerg    := "XFI240"  //Especifico CNI

AjustaSX1()

Pergunte(cPerg)

DbSelectArea("SE2")

If MV_PAR01 == 1
	
	SE2->(DBORDERNICKNAME("SISE201")) //Especifico CNI
	aIndTemp := {CriaTrab(,.F.)}
	IndRegua(_cAliasSE2,aIndTemp[1],SE2->(IndexKey()),,,"Indexando arquivo...")
	
ElseIf MV_PAR01 == 2
	
	SE2->(DbSetOrder(3))
	aIndTemp := {CriaTrab(,.F.)}
	IndRegua(_cAliasSE2,aIndTemp[1],SE2->(IndexKey()),,,"Indexando arquivo...")
	
Else
	Return nil
EndIf

RestArea(aArea)
RestArea(aAreaSE2)

Return aIndTemp

/*/
控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控�
控矬闡闡闡闡鐃闡闡闡闡闡薩闡闡闡薩闡闡闡闡闡闡闡闡闡闡闡薩闡闡鐃闡闡闡闡闡膨�
控蚶un��o    莧justaSX1 � Autor � Mary C. Hergert       � Data �05/07/2006陰�
控藥闡闡闡闡霰闡闡闡闡闡謐闡闡闡謐闡闡闡闡闡闡闡闡闡闡闡謐闡闡鐘闡闡闡闡闡敢�
控蛇escri��o 彪ria as perguntas necessarias a impressao do RPS            陰�
控藥闡闡闡闡霰闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡敢�
控� Uso      蛉ata916                                                     陰�
控斂闡闡闡闡鐘闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡闡棱�
控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控控�
葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔葔�
/*/
Static Function AjustaSX1()

Local	aHelpPor	:=	{}
Local	aARea		:=	GetArea()
Local	aAreaSX1	:=	SX1->(GetArea())

dbSelecTArea("SX1")
SX1->(dbSetOrder(1))

Aadd (aHelpPor, "Seleciona a ordem da apresenta誽o dos ")
Aadd (aHelpPor, "titulos a serem marcados para a gera誽o ")
Aadd (aHelpPor, "do bordero.")
u_SFPUTSX1(cPerg,"01","Ordem ?","Ordem ?","Ordem ?","mv_ch1","C",1,0,3,"C","","","","","MV_PAR01","Nome Fornecedor","","","","Vencto. Real","","","Padr緌","","","","","","","","",aHelpPor,aHelpPor,aHelpPor)

RestArea(aAreaSX1)
RestArea(aArea)

Return(.T.)
