#include 'protheus.ch'

/*/{Protheus.doc} CN140VCT
	Localizado na função CN140VLP3(), validação do Painel 3 do Wizard, 
	para a manutenção de revisões do contrato.
	Este ponto de entrada possibilita a revisão ou não para o Contrato, 
	selecionado no painel 3 do wizard.

]@author franklin.oliveira
@since 19/04/2016
@param PARAMIXB[1], Caracter, Código do Tipo do Contrato.
@param PARAMIXB[2], Caracter, Número do Contrato.
@version undefined
@type function

@return lRet, Lógico, .T. - Permite a revisão para o contrato selecionado. .F.-Não permite a revisão para o contrato selecionado.
/*/
User Function CN140VCT()

Local aArea		:= GetArea()

Local cExp1 	:= PARAMIXB[1]
Local cExp2 	:= PARAMIXB[2]

Local lRet 		:= .T.
Local lMedEvent	:= Posicione("CN1", 1, xFilial("CN1") + CN9->CN9_TPCTO, "CN1_MEDEVE") == "1"
Local lCtoVenda	:= Posicione("CN1", 1, xFilial("CN1") + CN9->CN9_TPCTO, "CN1_ESPCTR") == "2"
Local lCtoFlex	:= Posicione("CN1", 1, xFilial("CN1") + CN9->CN9_TPCTO, "CN1_CTRFIX") == "2"

	If SubStr(CN9->CN9_FILIAL, 1, 4) == '02MT'
		If !Empty(CN9->CN9_XOPORT) .And. !Empty(CN9->CN9_XREVOP) .And. lMedEvent .And. lCtoVenda .And. lCtoFlex
			lRet := .F.
			Help('', 1, 'CN140VCT', , "O Contrato selecionado deve ser aditivado pela rotina 'Aditivo Cto Venda'", 1, 0)
		EndIf
	EndIf
	
	RestArea(aArea)

Return lRet